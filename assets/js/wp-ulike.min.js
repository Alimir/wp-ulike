!function(i){"use strict";var s="WordpressUlikeNotifications",n={messageType:"success",messageText:"Hello World!",messageElement:"wpulike-message",notifContainer:"wpulike-notification"};function t(e,t){this.element=e,this.$element=i(e),this.settings=i.extend({},n,t),this._defaults=n,this._name=s,this.init()}i.extend(t.prototype,{init:function(){this._message(),this._container(),this._append(),this._remove()},_message:function(){this.$messageElement=i("<div/>").addClass(this.settings.messageElement+" wpulike-"+this.settings.messageType).text(this.settings.messageText)},_container:function(){i("."+this.settings.notifContainer).length||this.$element.append(i("<div/>").addClass(this.settings.notifContainer)),this.$notifContainer=this.$element.find("."+this.settings.notifContainer)},_append:function(){this.$notifContainer.append(this.$messageElement).trigger("WordpressUlikeNotificationAppend")},_remove:function(){var e=this;this.$messageElement.click(function(){i(this).fadeOut(300,function(){i(this).remove(),i("."+e.settings.messageElement).length||e.$notifContainer.remove()}).trigger("WordpressUlikeRemoveNotification")}),setTimeout(function(){e.$messageElement.fadeOut(300,function(){i(this).remove(),i("."+e.settings.messageElement).length||e.$notifContainer.remove()}).trigger("WordpressUlikeRemoveNotification")},8e3)}}),i.fn[s]=function(e){return this.each(function(){new t(this,e)})}}(jQuery,window,document),function(n,e,i){"use strict";var l="WordpressUlike",t=(n(e),n(i)),a={ID:0,nonce:0,type:"",append:"",appendTimeout:2e3,displayLikers:!1,disablePophover:!0,factor:"",counterSelector:".count-box",generalSelector:".wp_ulike_general_class",buttonSelector:".wp_ulike_btn",likersSelector:".wp_ulike_likers_wrapper"},o={"ulike-id":"ID","ulike-nonce":"nonce","ulike-type":"type","ulike-append":"append","ulike-display-likers":"displayLikers","ulike-disable-pophover":"disablePophover","ulike-append-timeout":"appendTimeout","ulike-factor":"factor"};function s(e,t){for(var i in this.element=e,this.$element=n(e),this.settings=n.extend({},a,t),this._defaults=a,this._name=l,this._refreshTheLikers=!1,this.buttonElement=this.$element.find(this.settings.buttonSelector),this.generalElement=this.$element.find(this.settings.generalSelector),this.counterElement=this.generalElement.find(this.settings.counterSelector),o){var s=this.buttonElement.data(i);void 0!==s&&(this.settings[o[i]]=s)}this.init()}n.extend(s.prototype,{init:function(){this.buttonElement.click(this._initLike.bind(this)),this.buttonElement.one("mouseenter",this._updateLikers.bind(this))},_ajax:function(e,t){n.ajax({url:wp_ulike_params.ajax_url,type:"POST",cache:!1,dataType:"json",data:e}).done(t)},_initLike:function(e){e.stopPropagation(),this._maybeUpdateElements(e),this._updateSameButtons(),this.buttonElement.prop("disabled",!0),t.trigger("WordpressUlikeLoading",this.element),this.generalElement.addClass("wp_ulike_is_loading"),this._ajax({action:"wp_ulike_process",id:this.settings.ID,nonce:this.settings.nonce,factor:this.settings.factor,type:this.settings.type},function(e){this.generalElement.removeClass("wp_ulike_is_loading"),e.success?(this._updateMarkup(e),this._appendChild()):this._sendNotification("error",e.data),this.buttonElement.prop("disabled",!1),t.trigger("WordpressUlikeUpdated",this.element)}.bind(this))},_maybeUpdateElements:function(e){this.buttonElement=n(e.currentTarget),this.generalElement=this.buttonElement.closest(this.settings.generalSelector),this.counterElement=this.generalElement.find(this.settings.counterSelector),this.settings.factor=this.buttonElement.data("ulike-factor")},_appendChild:function(){if(""!==this.settings.append){var e=n(this.settings.append);this.buttonElement.append(e),this.settings.appendTimeout&&setTimeout(function(){e.detach()},this.settings.appendTimeout)}},_updateMarkup:function(e){this._setSbilingElement(),this._updateGeneralClassNames(e.data.status),null!==e.data.data&&(e.data.status<5&&(this.__updateCounter(e.data.data),this._refreshTheLikers=!0),this._updateButton(e.data.btnText,e.data.status)),this._sendNotification(e.data.messageType,e.data.message),this._refreshTheLikers&&this._updateLikers()},_updateGeneralClassNames:function(e){var t="wp_ulike_is_not_liked",i="wp_ulike_is_liked",s="wp_ulike_is_unliked",n="wp_ulike_click_is_disabled";switch(this.siblingElement.length&&this.siblingElement.removeClass(this._arrayToString([i,s])),e){case 1:this.generalElement.addClass(i).removeClass(t),this.generalElement.children().first().addClass(n);break;case 2:this.generalElement.addClass(s).removeClass(i);break;case 3:this.generalElement.addClass(i).removeClass(s);break;default:this.generalElement.children().first().addClass(n),this.siblingElement.length&&this.siblingElement.children().first().addClass(n)}},_arrayToString:function(e){return e.join(" ")},_setSbilingElement:function(){this.siblingElement=this.generalElement.siblings()},__updateCounter:function(e){"object"!=typeof e?this.counterElement.text(e):"down"===this.settings.factor?(this.counterElement.text(e.down),this.siblingElement.length&&this.siblingElement.find(this.settings.counterSelector).text(e.up)):(this.counterElement.text(e.up),this.siblingElement.length&&this.siblingElement.find(this.settings.counterSelector).text(e.down)),t.trigger("WordpressUlikeCounterUpdated",[this.buttonElement])},_updateLikers:function(){this.likersElement=this._getLikersElement(),!this.settings.displayLikers||this.likersElement.length&&!this._refreshTheLikers||(this.generalElement.addClass("wp_ulike_is_getting_likers_list"),this._ajax({action:"wp_ulike_get_likers",id:this.settings.ID,nonce:this.settings.nonce,type:this.settings.type,disablePophover:this.settings.disablePophover,refresh:this._refreshTheLikers?1:0},function(e){this.generalElement.removeClass("wp_ulike_is_getting_likers_list"),e.success&&(this.likersElement.length||(this.likersElement=n("<div>",{class:e.data.class}).appendTo(this.$element)),e.data.template?this.likersElement.show().html(e.data.template):this.likersElement.hide()),this._refreshTheLikers=!1}.bind(this)))},_updateSameButtons:function(){var e=void 0!==this.settings.factor?this.settings.factor:"";this.sameButtons=t.find(".wp_"+this.settings.type.toLowerCase()+e+"_"+this.settings.ID),1<this.sameButtons.length&&(this.buttonElement=this.sameButtons,this.generalElement=this.buttonElement.closest(this.settings.generalSelector),this.counterElement=this.generalElement.find(this.settings.counterSelector))},_getLikersElement:function(){return this.$element.find(this.settings.likersSelector)},_updateButton:function(e,t){this.buttonElement.hasClass("wp_ulike_put_image")?(this.buttonElement.toggleClass("image-unlike wp_ulike_btn_is_active"),this.siblingElement.length&&this.siblingElement.find(this.settings.buttonSelector).removeClass("image-unlike wp_ulike_btn_is_active")):this.buttonElement.hasClass("wp_ulike_put_text")&&null!==e&&("object"!=typeof e?this.buttonElement.find("span").html(e):"down"===this.settings.factor?(this.buttonElement.find("span").html(e.down),this.siblingElement.length&&this.siblingElement.find(this.settings.buttonSelector).find("span").html(e.up)):(this.buttonElement.find("span").html(e.up),this.siblingElement.length&&this.siblingElement.find(this.settings.buttonSelector).find("span").html(e.down)))},_sendNotification:function(e,t){"1"===wp_ulike_params.notifications&&n(i.body).WordpressUlikeNotifications({messageType:e,messageText:t})}}),n.fn[l]=function(e){return this.each(function(){n.data(this,"plugin_"+l)||n.data(this,"plugin_"+l,new s(this,e))})}}(jQuery,window,document),function(t){t(function(){t(this).bind("DOMNodeInserted",function(e){t(".wpulike").WordpressUlike()})}),t(".wpulike").WordpressUlike()}(jQuery);